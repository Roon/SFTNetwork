SELECT a.l_subreddit as Source, b.l_subreddit as Target, COUNT(*) as Weight
FROM (
  SELECT author, LOWER(subreddit) as l_subreddit, COUNT(DISTINCT(link_id)) as unique_threads
  FROM [pushshift:rt_reddit.comments]
  WHERE lower(subreddit) in ('4dprinting', 'agi', 'aiclass', 'aihub', 'akira', 'algorithms', 'alife', 'allscifi', 'anarchotranshumanism', 'anarchotranshumanist', 'anonymous', 'apocalypse', 'art_int', 'artificial', 'artificialintel', 'artificialintellects', 'artintel', 'asc', 'asktechnology', 'astronomy', 'astrophysics', 'ationality', 'augment', 'augmentedreality', 'automate', 'automation', 'backgroundart', 'basicincome', 'bci', 'beyondhuman', 'bigdata', 'biocosmism', 'bioethics', 'biohackers', 'bioinformatics', 'biomedicalengineers', 'biopunks', 'biotech', 'blackhat', 'bladerunner', 'blinkenlights', 'c_realm', 'calorierestriction', 'cinematicreality', 'cityporn', 'climate', 'cloudcomputing', 'codes', 'cogsci', 'cogsys', 'collapse', 'compmathneuro', 'computervision', 'conspiracy', 'controlproblem', 'cosmology', 'crowdsourcing', 'cryonics', 'cryonicsinstitute', 'crypto', 'cryptocurrency', 'curiosityrover', 'cyber', 'cybernetics', 'cyberpunk', 'cyberpunk_music', 'cyberpunktalk', 'cyborg', 'cyborgs', 'dap', 'darkfuturology', 'darknetplan', 'datascience', 'descentintotyranny', 'deusex', 'development', 'digital_immortality', 'distributedvr', 'diybio', 'doyourealize', 'dystopia', 'eclipsephase', 'electricsheep', 'electricvehicles', 'elonmusk', 'envirotech', 'esports', 'evilbuildings', 'exoplanets', 'farmtech', 'filmnoir', 'fui', 'futurecities', 'futureconsequences', 'futureporn', 'futurestudies', 'futuretube', 'futurewhatif', 'futureworldproblems', 'futurism', 'futuristparty', 'futuristpolitics', 'futurology', 'geneticengineering', 'genomics', 'geoengineering', 'gerontology', 'ghost_in_the_shell', 'glitch_art', 'goldenpath', 'googlecardboard', 'googleglass', 'graphene', 'greenfuture', 'grin', 'gullu', 'hacking', 'history', 'hplus', 'humanimmortality', 'humaninterface', 'humanism', 'hydroxy', 'imaginarycityscapes', 'imaginarycyberpunk', 'imaginarytechnology', 'industrialmusic', 'inleaguewithrobots', 'inspirationmars', 'invitromeat', 'itsthefuture', 'kardashevone', 'latestagecapitalism', 'lesswrong', 'lifeextension', 'longevity', 'longnow', 'lostgeneration', 'machineintelligence', 'machinelearning', 'materials', 'matrix', 'mattepainting', 'moviecomputers', 'nano', 'nanotech', 'netsec', 'neuro', 'neurophilosophy', 'noospherism', 'nootropics', 'nootropics2', 'nootropictesting', 'oculus', 'onlineeducation', 'opendata', 'opensource', 'overpopulation', 'panichistory', 'particlephysics', 'philosophyoftech', 'piratebox', 'planned_economy_ai', 'postapocalyptic', 'postearth', 'posthumanism', 'postscarcity', 'printsf', 'projectcyberpunkworld', 'prosthetic', 'prosthetics', 'psychonaut', 'psychopharmacology', 'quantifiedself', 'quantum', 'quantumcomputing', 'rad_decentralization', 'rational', 'readcyberlaw', 'recruitinghell', 'redditspaceinitiative', 'reddittothefuture', 'renewableengergy', 'republicofscience', 'retrofuturism', 'robot', 'robotbuilders', 'robotics', 'robotworldnews', 'robowars', 'sciencefiction', 'scifi', 'seasteading', 'selfdrivingcars', 'selfimprovement', 'selftracking', 'semanticweb', 'sens', 'sharingeconomy', 'simulate', 'simulism', 'singularitarianism', 'singularity', 'singularitynetwork', 'singularityoverlords', 'skynet', 'socialcitizens', 'space', 'space_colonization', 'space_settlement', 'spaceexploration', 'spaceflight', 'spacesettlement', 'spacevideos', 'spacex', 'stallmanwasright', 'starparty', 'steampunk', 'stemcells', 'strings', 'strongai', 'subcultures', 'swarming', 'synthetic_biology', 'tdcs', 'technocracy', 'technology', 'techwar', 'thefutureisnow', 'thematrix', 'thesingularity', 'thevenusproject', 'timereddits', 'tothemoon', 'transhuman', 'transhumanevolution', 'transhumanism', 'transhumanist', 'tsis', 'tzm', 'utilitarian', 'utilitarianism', 'virtualreality', 'vision', 'wayofthefuture', 'wearables', 'whereismyflyingcar', 'worldoftomorrow', 'fleshworldproblems', 'anonymousphilosophy', 'grassrootslongevity')
  GROUP BY author, l_subreddit
  HAVING unique_threads >= 5) a JOIN (
  SELECT author, LOWER(subreddit) as l_subreddit, COUNT(DISTINCT(link_id)) as unique_threads
  FROM [pushshift:rt_reddit.comments]
  WHERE lower(subreddit) in ('4dprinting', 'agi', 'aiclass', 'aihub', 'akira', 'algorithms', 'alife', 'allscifi', 'anarchotranshumanism', 'anarchotranshumanist', 'anonymous', 'apocalypse', 'art_int', 'artificial', 'artificialintel', 'artificialintellects', 'artintel', 'asc', 'asktechnology', 'astronomy', 'astrophysics', 'ationality', 'augment', 'augmentedreality', 'automate', 'automation', 'backgroundart', 'basicincome', 'bci', 'beyondhuman', 'bigdata', 'biocosmism', 'bioethics', 'biohackers', 'bioinformatics', 'biomedicalengineers', 'biopunks', 'biotech', 'blackhat', 'bladerunner', 'blinkenlights', 'c_realm', 'calorierestriction', 'cinematicreality', 'cityporn', 'climate', 'cloudcomputing', 'codes', 'cogsci', 'cogsys', 'collapse', 'compmathneuro', 'computervision', 'conspiracy', 'controlproblem', 'cosmology', 'crowdsourcing', 'cryonics', 'cryonicsinstitute', 'crypto', 'cryptocurrency', 'curiosityrover', 'cyber', 'cybernetics', 'cyberpunk', 'cyberpunk_music', 'cyberpunktalk', 'cyborg', 'cyborgs', 'dap', 'darkfuturology', 'darknetplan', 'datascience', 'descentintotyranny', 'deusex', 'development', 'digital_immortality', 'distributedvr', 'diybio', 'doyourealize', 'dystopia', 'eclipsephase', 'electricsheep', 'electricvehicles', 'elonmusk', 'envirotech', 'esports', 'evilbuildings', 'exoplanets', 'farmtech', 'filmnoir', 'fui', 'futurecities', 'futureconsequences', 'futureporn', 'futurestudies', 'futuretube', 'futurewhatif', 'futureworldproblems', 'futurism', 'futuristparty', 'futuristpolitics', 'futurology', 'geneticengineering', 'genomics', 'geoengineering', 'gerontology', 'ghost_in_the_shell', 'glitch_art', 'goldenpath', 'googlecardboard', 'googleglass', 'graphene', 'greenfuture', 'grin', 'gullu', 'hacking', 'history', 'hplus', 'humanimmortality', 'humaninterface', 'humanism', 'hydroxy', 'imaginarycityscapes', 'imaginarycyberpunk', 'imaginarytechnology', 'industrialmusic', 'inleaguewithrobots', 'inspirationmars', 'invitromeat', 'itsthefuture', 'kardashevone', 'latestagecapitalism', 'lesswrong', 'lifeextension', 'longevity', 'longnow', 'lostgeneration', 'machineintelligence', 'machinelearning', 'materials', 'matrix', 'mattepainting', 'moviecomputers', 'nano', 'nanotech', 'netsec', 'neuro', 'neurophilosophy', 'noospherism', 'nootropics', 'nootropics2', 'nootropictesting', 'oculus', 'onlineeducation', 'opendata', 'opensource', 'overpopulation', 'panichistory', 'particlephysics', 'philosophyoftech', 'piratebox', 'planned_economy_ai', 'postapocalyptic', 'postearth', 'posthumanism', 'postscarcity', 'printsf', 'projectcyberpunkworld', 'prosthetic', 'prosthetics', 'psychonaut', 'psychopharmacology', 'quantifiedself', 'quantum', 'quantumcomputing', 'rad_decentralization', 'rational', 'readcyberlaw', 'recruitinghell', 'redditspaceinitiative', 'reddittothefuture', 'renewableengergy', 'republicofscience', 'retrofuturism', 'robot', 'robotbuilders', 'robotics', 'robotworldnews', 'robowars', 'sciencefiction', 'scifi', 'seasteading', 'selfdrivingcars', 'selfimprovement', 'selftracking', 'semanticweb', 'sens', 'sharingeconomy', 'simulate', 'simulism', 'singularitarianism', 'singularity', 'singularitynetwork', 'singularityoverlords', 'skynet', 'socialcitizens', 'space', 'space_colonization', 'space_settlement', 'spaceexploration', 'spaceflight', 'spacesettlement', 'spacevideos', 'spacex', 'stallmanwasright', 'starparty', 'steampunk', 'stemcells', 'strings', 'strongai', 'subcultures', 'swarming', 'synthetic_biology', 'tdcs', 'technocracy', 'technology', 'techwar', 'thefutureisnow', 'thematrix', 'thesingularity', 'thevenusproject', 'timereddits', 'tothemoon', 'transhuman', 'transhumanevolution', 'transhumanism', 'transhumanist', 'tsis', 'tzm', 'utilitarian', 'utilitarianism', 'virtualreality', 'vision', 'wayofthefuture', 'wearables', 'whereismyflyingcar', 'worldoftomorrow', 'fleshworldproblems', 'anonymousphilosophy', 'grassrootslongevity')
  GROUP BY author, l_subreddit
  HAVING unique_threads >= 5) b ON a.author = b.author
GROUP BY Source, Target
HAVING Source < Target AND Weight >= 200
ORDER BY Weight DESC
